<% if @files %>
  <%= check_box_tag "defaultEmbargo", "Yes", false %> Use this as the default embargo for all files
  <% @files.each_with_index do |file, n| %>
    <div class="fileInfo">
      <legend>Access information for <%=file['name']%></legend>
      <h4>
        <% if file['thumbnail_url'] %>
          <span class=""><img src="/assets/<%=file['thumbnail_url']%>" alt="View file" /></span>
        <% end %>
        <span><a href="<%=file['url']%>" title="<%=file['name']%>" rel= "<%=file['thumbnail_url']%> gallery" download= "<%file['name']%>" target="_blank"><%= file['name'] %></a> </span>
        <span>(<%=ActionController::Base.helpers.number_to_human_size(file['size'], precision: 2)%>)</span>
        <span class="label label-warning"><%= link_to 'Delete', "#", method: :delete, data: { confirm: 'Are you sure?' } %></span>
      </h4>
      <!-- get the file details -->
      <% dsid = file['url'].split("/")[-1] %>
      <% select = nil %>
      <% if !@article.hasPart.empty? %>
        <% @article.hasPart.each do |hp| %>
          <% if hp.identifier.first == dsid %>
            <% select = hp %>
          <% end %>
        <% end %>
      <% end %>
      <% if select.nil? %>
        <% @article.hasPart.build %>
        <% select = @article.hasPart[n] %>
      <% end %>
      <div class="field">
        <%= hidden_field_tag "article[hasPart][#{n}][identifier]", dsid %>
        <%= label_tag "article[hasPart][#{n}][type]", "Type of file", :class=>"control-label" %>
        <% if !select.nil? and !select.type.empty? %>
          <%= select_tag "article[hasPart][#{n}][type]", options_for_select(Sufia.config.attachment_types, :selected=>select.type.first) %>
        <% else %>
          <%= select_tag "article[hasPart][#{n}][type]", options_for_select(Sufia.config.attachment_types) %>
        <% end %>
      </div>
      <div class="field">
        <%= label_tag "article[hasPart][#{n}][description]", "Description of file", :class=>"control-label" %>
        <% if !select.nil? and !select.description.empty? %>
          <%= text_field_tag "article[hasPart][#{n}][description]", select.description.first %>
        <% else %>
          <%= text_field_tag "article[hasPart][#{n}][description]" %>
        <% end %> 
      </div>
      <%= render partial: 'shared/file_embargo_fields_edit', as: :article, :locals => { :f => f, :hp => select, :n => n } %>
    </div><!-- /.fileInfo -->
  <% end %>
<% end %>

